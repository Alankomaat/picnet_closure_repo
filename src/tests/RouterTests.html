<!doctype html>
<html>
  <head></head>
  <body>
    <script src="http://localhost/shared/closure-library/closure/goog/base.js"></script>
    <script src="../deps.js"></script>
    <script>
goog.require('goog.testing.jsunit');
    </script>
    <script>
goog.require('pn.app.Router');

var startUri = document.location.href.split('#')[0];
var router;
var actions = [];

var getAction = function(name) {
  return function() { actions.push(name); };
};

var setUpPage = function() {  
};

var setUp = function() {  
  var actions = [];
};

var tearDown = function() {
  goog.dispose(router);
};

var testDefaultRouteIsSetOnCreation = function () {      
  router = new pn.app.Router({'default': getAction('default')}, 'default', true);
  assertRoute('default');  
};

var testInvalidDefaultRouteThrowsError = function() {
  try { 
    router = new pn.app.Router({'default':getAction('default')}, 'non-existing', true);  
    assertFail('Should have failed as "non-existing" is not in the routes map');
  } catch (ex) {}  
};

var testSwitchingBetween2ValidRoutes = function() {
  router = new pn.app.Router({
    'route1': getAction('route1'),
    'route2': getAction('route2')
  }, 'route1', true);  
  assertRoute('route1');
    
  router.navigate('route2');
  assertRoute('route2');
  
  router.navigate('route1');    
  assertRoute('route1');        
};

var testSwitchingToAnInvalidRoute = function() {
  router = new pn.app.Router({
    'route1': getAction('route1'),
    'route2': getAction('route2')
  }, 'route1', true);    
    
  try { 
    router.navigate('invalid-route');
    assertFail('Should have failed as "non-existing" is not in the routes map');
  } catch (ex) {}  
};

function assertRoute(route) {
  var lastAction = actions[actions.length - 1];
  assertEquals(route, lastAction);  
}
    </script>    
  </body>
</html>